***********************************
Starting job: run_train_bart_coref.py --add_special_tokens=../data_object_special/simmc_special_tokens.json --item2id=./item2id.json --train_input_file=../data_object_special/simmc2_dials_dstc10_train_predict.txt --train_target_file=../data_object_special/simmc2_dials_dstc10_train_target.txt --eval_input_file=../data_object_special/simmc2_dials_dstc10_devtest_predict.txt --eval_target_file=../data_object_special/simmc2_dials_dstc10_devtest_target.txt --output_dir=../coref_models/num_targets_learn_weight_ratio8 --train_batch_size=8 --output_eval_file=../coref_models/num_targets_learn_weight_ratio8/report.txt --num_train_epochs=8 --eval_steps=3000 --warmup_steps=8000 --num_objs_head True  PATH=/rmt/dialogue2/interns/alejandro/anaconda3/envs/mmcr_env/bin:/tmp/4037448.1.GPU25-0:/usr/local/bin:/bin:/usr/bin; TIME=Wed 13 Jul 12:10:08 GMT 2022
***********************************

Setting free GPU to number: 0
/rmt/dialogue2/interns/alejandro/simmc2-Multimodal_Coreference_Resolution/models/bart_only_coref/scripts
Linux stg-gpu25.crl.toshiba.co.uk 3.10.0-1160.59.1.el7.x86_64 #1 SMP Wed Feb 23 16:47:03 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
No multiple free GPUs...
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 4864 7190 129450
EVALUATION: {'fashion_coref': tensor(0.0319, device='cuda:0'), 'furniture_coref': tensor(0.0359, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.1775, device='cuda:0'), 'coref_info': 'rec: 0.6764951321279555, prec: 0.03757435303205871, f1: 0.0711943793911007'}
Data file : ../data_object_special/simmc2_dials_dstc10_train_predict.txt
Done Load Main File....
Truncating from 38127 examples to 38120
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 4834 7190 5999
EVALUATION: {'fashion_coref': tensor(0.6837, device='cuda:0'), 'furniture_coref': tensor(0.8427, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.9789, device='cuda:0'), 'coref_info': 'rec: 0.6723226703755215, prec: 0.8058009668278047, f1: 0.7330351050117522'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 4478 7190 5189
EVALUATION: {'fashion_coref': tensor(0.6785, device='cuda:0'), 'furniture_coref': tensor(0.8388, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.9809, device='cuda:0'), 'coref_info': 'rec: 0.6228094575799722, prec: 0.8629793794565427, f1: 0.7234833185233055'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 4700 7190 5654
EVALUATION: {'fashion_coref': tensor(0.6863, device='cuda:0'), 'furniture_coref': tensor(0.8490, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.9796, device='cuda:0'), 'coref_info': 'rec: 0.6536856745479833, prec: 0.8312698974177574, f1: 0.7318592338835254'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5183 7190 6609
EVALUATION: {'fashion_coref': tensor(0.6935, device='cuda:0'), 'furniture_coref': tensor(0.8524, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.9803, device='cuda:0'), 'coref_info': 'rec: 0.7208623087621697, prec: 0.7842336208200938, f1: 0.7512138560765274'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 4605 7190 5468
EVALUATION: {'fashion_coref': tensor(0.6871, device='cuda:0'), 'furniture_coref': tensor(0.8476, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.9807, device='cuda:0'), 'coref_info': 'rec: 0.6404728789986092, prec: 0.8421726408193123, f1: 0.7276030968557433'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5077 7190 6354
EVALUATION: {'fashion_coref': tensor(0.6976, device='cuda:0'), 'furniture_coref': tensor(0.8626, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.9808, device='cuda:0'), 'coref_info': 'rec: 0.7061196105702364, prec: 0.7990242367012905, f1: 0.7497046662728882'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5072 7190 6345
EVALUATION: {'fashion_coref': tensor(0.7028, device='cuda:0'), 'furniture_coref': tensor(0.8646, device='cuda:0'), 'num_target_objs_accuracy': tensor(0.9799, device='cuda:0'), 'coref_info': 'rec: 0.7054242002781641, prec: 0.7993695823483058, f1: 0.7494643516808275'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
***********************************
Finished job: run_train_bart_coref.py --add_special_tokens=../data_object_special/simmc_special_tokens.json --item2id=./item2id.json --train_input_file=../data_object_special/simmc2_dials_dstc10_train_predict.txt --train_target_file=../data_object_special/simmc2_dials_dstc10_train_target.txt --eval_input_file=../data_object_special/simmc2_dials_dstc10_devtest_predict.txt --eval_target_file=../data_object_special/simmc2_dials_dstc10_devtest_target.txt --output_dir=../coref_models/num_targets_learn_weight_ratio8 --train_batch_size=8 --output_eval_file=../coref_models/num_targets_learn_weight_ratio8/report.txt --num_train_epochs=8 --eval_steps=3000 --warmup_steps=8000 --num_objs_head True  PATH=/rmt/dialogue2/interns/alejandro/anaconda3/envs/mmcr_env/bin:/tmp/4037448.1.GPU25-0:/usr/local/bin:/bin:/usr/bin; GPU=+_GPUUU; TIME=Wed 13 Jul 17:12:19 GMT 2022
***********************************

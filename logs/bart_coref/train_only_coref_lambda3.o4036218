***********************************
Starting job: run_train_bart_coref.py --add_special_tokens=../data_object_special/simmc_special_tokens.json --item2id=./item2id.json --train_input_file=../data_object_special/simmc2_dials_dstc10_train_predict.txt --train_target_file=../data_object_special/simmc2_dials_dstc10_train_target.txt --eval_input_file=../data_object_special/simmc2_dials_dstc10_devtest_predict.txt --eval_target_file=../data_object_special/simmc2_dials_dstc10_devtest_target.txt --output_dir=../coref_models/test_model_0_3 --train_batch_size=8 --output_eval_file=../coref_models/test_model_0_3/report.txt --num_train_epochs=8 --eval_steps=3000 --warmup_steps=8000  PATH=/rmt/dialogue2/interns/alejandro/anaconda3/envs/mmcr_env/bin:/tmp/4036218.1.GPU25-0:/usr/local/bin:/bin:/usr/bin; TIME=Fri  3 Jun 23:33:38 GMT 2022
***********************************

Setting free GPU to number: 0
/rmt/dialogue2/interns/alejandro/simmc2-Multimodal_Coreference_Resolution/models/bart_coref/scripts
Linux stg-gpu25.crl.toshiba.co.uk 3.10.0-1160.59.1.el7.x86_64 #1 SMP Wed Feb 23 16:47:03 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
Data file : ../data_object_special/simmc2_dials_dstc10_train_predict.txt
Done Load Main File....
Truncating from 38127 examples to 38120
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5429 7190 7273
EVALUATION: {'nocoref': tensor(0.3454, device='cuda:0'), 'fashion_coref': tensor(0.6851, device='cuda:0'), 'fashion_size': tensor(0.1722, device='cuda:0'), 'fashion_available_sizes': tensor(0., device='cuda:0'), 'fashion_brand': tensor(0.0500, device='cuda:0'), 'fashion_color': tensor(0.0151, device='cuda:0'), 'fashion_pattern': tensor(0.0081, device='cuda:0'), 'fashion_sleeve_length': tensor(0.1234, device='cuda:0'), 'fashion_asset_type': tensor(0.0730, device='cuda:0'), 'fashion_type': tensor(0.0513, device='cuda:0'), 'fashion_price': tensor(0.0293, device='cuda:0'), 'fashion_customer_review': tensor(0.0376, device='cuda:0'), 'furniture_coref': tensor(0.8374, device='cuda:0'), 'furniture_brand': tensor(0.2502, device='cuda:0'), 'furniture_color': tensor(0.0612, device='cuda:0'), 'furniture_materials': tensor(0.0335, device='cuda:0'), 'furniture_type': tensor(0.0748, device='cuda:0'), 'furniture_price': tensor(0.0787, device='cuda:0'), 'furniture_customer_review': tensor(0.0993, device='cuda:0'), 'coref_info': 'rec: 0.7550764951321279, prec: 0.7464595077684587, f1: 0.7507432759455162'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 4782 7190 5941
EVALUATION: {'nocoref': tensor(0.4435, device='cuda:0'), 'fashion_coref': tensor(0.6830, device='cuda:0'), 'fashion_size': tensor(0.1725, device='cuda:0'), 'fashion_available_sizes': tensor(0., device='cuda:0'), 'fashion_brand': tensor(0.0497, device='cuda:0'), 'fashion_color': tensor(0.0153, device='cuda:0'), 'fashion_pattern': tensor(0.0081, device='cuda:0'), 'fashion_sleeve_length': tensor(0.1225, device='cuda:0'), 'fashion_asset_type': tensor(0.0558, device='cuda:0'), 'fashion_type': tensor(0.0514, device='cuda:0'), 'fashion_price': tensor(0.0293, device='cuda:0'), 'fashion_customer_review': tensor(0.0360, device='cuda:0'), 'furniture_coref': tensor(0.8369, device='cuda:0'), 'furniture_brand': tensor(0.2528, device='cuda:0'), 'furniture_color': tensor(0.0495, device='cuda:0'), 'furniture_materials': tensor(0.0281, device='cuda:0'), 'furniture_type': tensor(0.0735, device='cuda:0'), 'furniture_price': tensor(0.0777, device='cuda:0'), 'furniture_customer_review': tensor(0.1003, device='cuda:0'), 'coref_info': 'rec: 0.6650904033379694, prec: 0.8049149974751725, f1: 0.7283527530271876'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5130 7190 6525
EVALUATION: {'nocoref': tensor(0.4069, device='cuda:0'), 'fashion_coref': tensor(0.7002, device='cuda:0'), 'fashion_size': tensor(0.1720, device='cuda:0'), 'fashion_available_sizes': tensor(0., device='cuda:0'), 'fashion_brand': tensor(0.0499, device='cuda:0'), 'fashion_color': tensor(0.0152, device='cuda:0'), 'fashion_pattern': tensor(0.0078, device='cuda:0'), 'fashion_sleeve_length': tensor(0.1229, device='cuda:0'), 'fashion_asset_type': tensor(0.0666, device='cuda:0'), 'fashion_type': tensor(0.0514, device='cuda:0'), 'fashion_price': tensor(0.0300, device='cuda:0'), 'fashion_customer_review': tensor(0.0329, device='cuda:0'), 'furniture_coref': tensor(0.8534, device='cuda:0'), 'furniture_brand': tensor(0.2514, device='cuda:0'), 'furniture_color': tensor(0.0780, device='cuda:0'), 'furniture_materials': tensor(0.0374, device='cuda:0'), 'furniture_type': tensor(0.0740, device='cuda:0'), 'furniture_price': tensor(0.0800, device='cuda:0'), 'furniture_customer_review': tensor(0.1004, device='cuda:0'), 'coref_info': 'rec: 0.713490959666203, prec: 0.7862068965517242, f1: 0.7480860371855633'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5097 7190 6396
EVALUATION: {'nocoref': tensor(0.4033, device='cuda:0'), 'fashion_coref': tensor(0.7060, device='cuda:0'), 'fashion_size': tensor(0.1717, device='cuda:0'), 'fashion_available_sizes': tensor(0., device='cuda:0'), 'fashion_brand': tensor(0.0499, device='cuda:0'), 'fashion_color': tensor(0.0152, device='cuda:0'), 'fashion_pattern': tensor(0.0078, device='cuda:0'), 'fashion_sleeve_length': tensor(0.1273, device='cuda:0'), 'fashion_asset_type': tensor(0.0764, device='cuda:0'), 'fashion_type': tensor(0.0515, device='cuda:0'), 'fashion_price': tensor(0.0295, device='cuda:0'), 'fashion_customer_review': tensor(0.0325, device='cuda:0'), 'furniture_coref': tensor(0.8437, device='cuda:0'), 'furniture_brand': tensor(0.2513, device='cuda:0'), 'furniture_color': tensor(0.0622, device='cuda:0'), 'furniture_materials': tensor(0.0330, device='cuda:0'), 'furniture_type': tensor(0.0732, device='cuda:0'), 'furniture_price': tensor(0.0835, device='cuda:0'), 'furniture_customer_review': tensor(0.1009, device='cuda:0'), 'coref_info': 'rec: 0.7089012517385257, prec: 0.7969043151969981, f1: 0.7503312233181215'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 4974 7190 6121
EVALUATION: {'nocoref': tensor(0.4370, device='cuda:0'), 'fashion_coref': tensor(0.7063, device='cuda:0'), 'fashion_size': tensor(0.1719, device='cuda:0'), 'fashion_available_sizes': tensor(0., device='cuda:0'), 'fashion_brand': tensor(0.0500, device='cuda:0'), 'fashion_color': tensor(0.0153, device='cuda:0'), 'fashion_pattern': tensor(0.0079, device='cuda:0'), 'fashion_sleeve_length': tensor(0.1232, device='cuda:0'), 'fashion_asset_type': tensor(0.0758, device='cuda:0'), 'fashion_type': tensor(0.0514, device='cuda:0'), 'fashion_price': tensor(0.0294, device='cuda:0'), 'fashion_customer_review': tensor(0.0372, device='cuda:0'), 'furniture_coref': tensor(0.8607, device='cuda:0'), 'furniture_brand': tensor(0.2521, device='cuda:0'), 'furniture_color': tensor(0.0884, device='cuda:0'), 'furniture_materials': tensor(0.0378, device='cuda:0'), 'furniture_type': tensor(0.0751, device='cuda:0'), 'furniture_price': tensor(0.0830, device='cuda:0'), 'furniture_customer_review': tensor(0.1013, device='cuda:0'), 'coref_info': 'rec: 0.6917941585535466, prec: 0.8126123182486522, f1: 0.7473518142889339'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5067 7190 6295
EVALUATION: {'nocoref': tensor(0.3671, device='cuda:0'), 'fashion_coref': tensor(0.7103, device='cuda:0'), 'fashion_size': tensor(0.1713, device='cuda:0'), 'fashion_available_sizes': tensor(0., device='cuda:0'), 'fashion_brand': tensor(0.0499, device='cuda:0'), 'fashion_color': tensor(0.0153, device='cuda:0'), 'fashion_pattern': tensor(0.0080, device='cuda:0'), 'fashion_sleeve_length': tensor(0.1242, device='cuda:0'), 'fashion_asset_type': tensor(0.0755, device='cuda:0'), 'fashion_type': tensor(0.0516, device='cuda:0'), 'fashion_price': tensor(0.0296, device='cuda:0'), 'fashion_customer_review': tensor(0.0358, device='cuda:0'), 'furniture_coref': tensor(0.8587, device='cuda:0'), 'furniture_brand': tensor(0.2537, device='cuda:0'), 'furniture_color': tensor(0.0861, device='cuda:0'), 'furniture_materials': tensor(0.0377, device='cuda:0'), 'furniture_type': tensor(0.0774, device='cuda:0'), 'furniture_price': tensor(0.0875, device='cuda:0'), 'furniture_customer_review': tensor(0.1011, device='cuda:0'), 'coref_info': 'rec: 0.7047287899860918, prec: 0.8049245432883241, f1: 0.7515016685205785'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
Data file : ../data_object_special/simmc2_dials_dstc10_devtest_predict.txt
Done Load Main File....
Truncating from 8609 examples to 8608
total coref result: 5124 7190 6388
EVALUATION: {'nocoref': tensor(0.3363, device='cuda:0'), 'fashion_coref': tensor(0.7162, device='cuda:0'), 'fashion_size': tensor(0.1717, device='cuda:0'), 'fashion_available_sizes': tensor(0., device='cuda:0'), 'fashion_brand': tensor(0.0498, device='cuda:0'), 'fashion_color': tensor(0.0153, device='cuda:0'), 'fashion_pattern': tensor(0.0079, device='cuda:0'), 'fashion_sleeve_length': tensor(0.1248, device='cuda:0'), 'fashion_asset_type': tensor(0.0719, device='cuda:0'), 'fashion_type': tensor(0.0515, device='cuda:0'), 'fashion_price': tensor(0.0296, device='cuda:0'), 'fashion_customer_review': tensor(0.0374, device='cuda:0'), 'furniture_coref': tensor(0.8612, device='cuda:0'), 'furniture_brand': tensor(0.2532, device='cuda:0'), 'furniture_color': tensor(0.0843, device='cuda:0'), 'furniture_materials': tensor(0.0398, device='cuda:0'), 'furniture_type': tensor(0.0753, device='cuda:0'), 'furniture_price': tensor(0.0818, device='cuda:0'), 'furniture_customer_review': tensor(0.1005, device='cuda:0'), 'coref_info': 'rec: 0.7126564673157163, prec: 0.802128991859737, f1: 0.754750331418471'}
checkpoint saving!!
checkpoint saving!!
checkpoint saving!!
***********************************
Finished job: run_train_bart_coref.py --add_special_tokens=../data_object_special/simmc_special_tokens.json --item2id=./item2id.json --train_input_file=../data_object_special/simmc2_dials_dstc10_train_predict.txt --train_target_file=../data_object_special/simmc2_dials_dstc10_train_target.txt --eval_input_file=../data_object_special/simmc2_dials_dstc10_devtest_predict.txt --eval_target_file=../data_object_special/simmc2_dials_dstc10_devtest_target.txt --output_dir=../coref_models/test_model_0_3 --train_batch_size=8 --output_eval_file=../coref_models/test_model_0_3/report.txt --num_train_epochs=8 --eval_steps=3000 --warmup_steps=8000  PATH=/rmt/dialogue2/interns/alejandro/anaconda3/envs/mmcr_env/bin:/tmp/4036218.1.GPU25-0:/usr/local/bin:/bin:/usr/bin; GPU=+_GPUUU; TIME=Sat  4 Jun 04:35:52 GMT 2022
***********************************
